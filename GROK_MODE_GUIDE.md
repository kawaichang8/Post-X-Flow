# Grok専用モード強化ガイド

Post-X-FlowのGrok専用モード強化機能の実装内容と使用方法を説明します。

## 実装内容

### 1. Grok APIをデフォルトに変更

- **変更前**: Claude APIが優先、Grokはフォールバック
- **変更後**: Grok APIがデフォルト、Claudeは明示的に選択した場合のみ使用

### 2. ユーモア注入オプション

Grokの特徴的な風刺的視点や軽いユーモアを適度に注入するオプションを追加しました。

**機能**:
- チェックボックスで有効/無効を切り替え
- Grok専用機能（Claudeでは利用不可）
- 投稿の魅力とエンゲージメント向上を目的

**使用方法**:
1. ツイート生成画面で「詳細設定」を開く
2. 「ユーモア注入」チェックボックスを有効化
3. ツイートを生成

### 3. リアルタイム知識挿入（最新トレンド反映）

最新のトレンド情報を自動取得し、生成時に反映する機能を追加しました。

**機能**:
- Twitter連携が必要
- リアルタイムトレンドを自動取得
- 生成時に最新トレンド情報を反映
- 時事性の高い投稿が可能

**使用方法**:
1. Twitter連携を完了
2. ツイート生成画面で「詳細設定」を開く
3. 「リアルタイム知識挿入」チェックボックスを有効化
4. ツイートを生成（最新トレンドが自動反映）

### 4. Claude/Grok切り替えUI改善

AIプロバイダーの選択UIを改善し、各プロバイダーの特徴を明確に表示しました。

**機能**:
- 視覚的なプロバイダー選択（カード形式）
- 各プロバイダーの特徴を表示
- Grokは「推奨」バッジを表示
- 詳細設定パネルで展開/折りたたみ可能

## 使用方法

### 基本的な使い方

1. **ダッシュボード**で「ツイート」タブを開く
2. **トレンドキーワード**と**投稿目的**を入力
3. **「詳細設定」**ボタンをクリック（オプション）
4. **AIプロバイダー**を選択（デフォルト: Grok）
5. **Grok専用オプション**を設定（必要に応じて）:
   - ユーモア注入: チェックボックスで有効化
   - リアルタイム知識挿入: チェックボックスで有効化（Twitter連携必要）
6. **「Grokで生成」**または**「Claudeで生成」**ボタンをクリック

### オプションの組み合わせ

#### パターン1: 標準的な生成（デフォルト）
- AIプロバイダー: Grok
- ユーモア注入: 無効
- リアルタイム知識挿入: 無効

#### パターン2: ユーモア重視
- AIプロバイダー: Grok
- ユーモア注入: **有効**
- リアルタイム知識挿入: 無効

#### パターン3: 時事性重視
- AIプロバイダー: Grok
- ユーモア注入: 無効
- リアルタイム知識挿入: **有効**（Twitter連携必要）

#### パターン4: 最大限活用
- AIプロバイダー: Grok
- ユーモア注入: **有効**
- リアルタイム知識挿入: **有効**（Twitter連携必要）

#### パターン5: Claude使用
- AIプロバイダー: Claude
- （Grok専用オプションは利用不可）

## 技術的な実装

### API変更

#### `lib/ai-generator.ts`

```typescript
export interface GeneratePostsParams {
  trend: string
  purpose: string
  aiProvider?: 'grok' | 'claude' // デフォルト: 'grok'
  enableHumor?: boolean // ユーモア注入オプション（Grok専用）
  enableRealtimeKnowledge?: boolean // リアルタイム知識挿入（Grok専用）
  realtimeTrends?: string[] // 最新トレンド情報（オプション）
}
```

#### `app/actions.ts`

```typescript
export async function generatePostDrafts(
  trend: string,
  purpose: string,
  options?: {
    aiProvider?: 'grok' | 'claude'
    enableHumor?: boolean
    enableRealtimeKnowledge?: boolean
    realtimeTrends?: string[]
  }
): Promise<PostDraft[]>
```

### UI変更

#### `components/GenerateForm.tsx`

- AIプロバイダー選択UIを追加
- Grok専用オプション（ユーモア注入、リアルタイム知識挿入）を追加
- 詳細設定パネルを追加

### プロンプトテンプレート

Grok専用プロンプトテンプレート（`GROK_PROMPT_TEMPLATE`）を追加:

- ユーモア要件セクション（`{humorRequirement}`）
- リアルタイム要件セクション（`{realtimeRequirement}`）
- 最新トレンド情報セクション（`{realtimeKnowledge}`）

## 期待される効果

### ユーモア注入オプション

- **エンゲージメント向上**: ユーモアのある投稿はリツイートやいいねが増加
- **ブランド認知**: 特徴的なトーンでブランド認知度が向上
- **自然さ**: Grokの風刺的視点で自然な投稿が生成

### リアルタイム知識挿入

- **時事性**: 最新トレンドを反映した投稿で注目度が向上
- **関連性**: 現在の話題に関連した投稿でエンゲージメントが増加
- **価値提供**: 最新情報を含む投稿でフォロワーに価値を提供

## 注意事項

1. **Twitter連携**: リアルタイム知識挿入を使用するにはTwitter連携が必要です
2. **APIキー**: Grok APIキー（`GROK_API_KEY`）が設定されている必要があります
3. **レート制限**: Grok APIのレート制限に注意してください
4. **ユーモアの程度**: ユーモア注入は適度に使用してください（過度な使用は避ける）

## トラブルシューティング

### リアルタイム知識挿入が動作しない

- Twitter連携が完了しているか確認
- トレンド取得が成功しているか確認（「トレンド表示」ボタンで確認）
- ブラウザのコンソールでエラーを確認

### ユーモア注入が効かない

- Grok APIが選択されているか確認
- APIキーが正しく設定されているか確認
- プロンプトが正しく生成されているか確認（開発者ツールで確認）

### Claudeに切り替えられない

- Claude APIキー（`ANTHROPIC_API_KEY`）が設定されているか確認
- 環境変数を確認

## 今後の拡張

- ユーモアの強度調整（弱/中/強）
- リアルタイム知識のソース追加（ニュース、SNSトレンドなど）
- 生成履歴でのオプション記録
- A/Bテスト機能（ユーモア有無での比較）

## 参考資料

- [Grok API Documentation](https://docs.x.ai/)
- [X API v2 Documentation](https://developer.twitter.com/en/docs/twitter-api)
- [Post-X-Flow README](./README.md)
